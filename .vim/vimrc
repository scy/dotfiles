" Basic settings: Ignore vi compatibility, use filetype plugins, syntax
" highlighting and UTF-8.
set nocompatible
filetype plugin on
syntax on
set encoding=utf-8

" Disable modelines for security reasons, see CVE-2019-12735 et al.
" They are off by default on Debian, but "set nocompatible" above will have
" turned them on nevertheless.
set nomodeline

" Leader character for mappings.
let mapleader=","
let maplocalleader=","

" In the viminfo state file, store file marks and unlimited register contents.
" Search, command line and input history size are defined via 'history'.
" Also, put the viminfo file in ~/.vim, not directly in the home directory.
" In Neovim, 'viminfo' is an alias to 'shada', but viminfo and ShaDa files are
" incompatible. So on a system running both Vim and Neovim, 'viminfo'/'shada'
" should point to different files.
set viminfo='100,h,f1
if has('nvim')
	set shada+=n~/.vim/shada
else
	set viminfo+=n~/.vim/viminfo
endif
set history=100

" Don't litter .swp files all over the place, put them in ~/.vim/swp instead,
" but fall back to "same directory" if that's not possible for some reason.
set directory=~/.vim/swp,.

" Dark background, duh.
set background=dark

" When splitting vertically, split to the right (not to the left). Similarly,
" when splitting horizontally, split below (not to the top).
set splitright splitbelow

" Changing cursors on mode change.
if &term =~ "xterm"
	let &t_SI = "\<Esc>[5 q" " blinking bar
	let &t_SR = "\<Esc>[3 q" " blinking underscore
	let &t_EI = "\<Esc>[1 q" " blinking block
endif

" netrw config.
" Disable the banner.
let g:netrw_banner = 0
" When selecting a file, open it in the previous window (or create a new one).
let g:netrw_browse_split = 4
" Show files as a tree by default.
let g:netrw_liststyle = 3
" Default size of the split explorer is 20%.
let g:netrw_winsize = 20

" Configure my Vimwiki.
" When creating a link in a Markdown file, add the `.md` extension.
let g:vimwiki_markdown_link_ext = 1
let g:vimwiki_list = [{
	\ 'path': '~/my/w',
	\ 'syntax': 'markdown',
	\ 'ext': '.md',
\ }]

" Mappings.
" Toggle file tree.
map <Leader>l :Lexplore<CR>
" Open a terminal window shell that closes automatically when exiting.
map <Leader>! :terminal ++close<CR>
